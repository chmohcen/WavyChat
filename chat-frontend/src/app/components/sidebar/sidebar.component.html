<div class="sidebar">
  <!-- Header -->
  <div class="sidebar__header">
    <div class="user-profile" *ngIf="currentUser$ | async as user">
      <img [src]="user.avatar" alt="User Avatar" class="user-profile__avatar">
      <div class="user-profile__status" [style.background-color]="getStatusColor(user.status)"></div>
    </div>
    <div class="sidebar__actions">
      <button class="action-btn" title="Start new chat">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 5v14M5 12h14"></path>
        </svg>
      </button>
    </div>
  </div>

  <!-- Search -->
  <div class="sidebar__search">
    <input
      type="text"
      placeholder="Search conversations..."
      class="search-input"
      [(ngModel)]="searchQuery"
      (input)="onSearch(searchQuery)"
    >
    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="search-input__icon">
      <circle cx="11" cy="11" r="8"></circle>
      <path d="m21 21-4.35-4.35"></path>
    </svg>
  </div>

  <!-- Chat List -->
  <div class="sidebar__chats">
    <div
      *ngFor="let chat of filteredChats$ | async"
      class="chat-item"
      [class.chat-item--active]="selectedChatId === chat.id"
      (click)="selectChat(chat)"
    >
      <div class="chat-item__avatar-wrapper">
        <img [src]="chat.participants[0].avatar" alt="Chat Avatar" class="chat-item__avatar">
        <div
          class="chat-item__status"
          [style.background-color]="getStatusColor(chat.participants[0].status)"
        ></div>
      </div>

      <div class="chat-item__content">
        <div class="chat-item__header">
          <h3 class="chat-item__name">{{ chat.participants[0].name }}</h3>
          <span class="chat-item__time">
            {{ chat.lastMessageTime | date: 'short' }}
          </span>
        </div>
        <p class="chat-item__message">{{ chat.lastMessage }}</p>
      </div>

      <div *ngIf="chat.unreadCount > 0" class="chat-item__badge">
        {{ chat.unreadCount }}
      </div>
    </div>
  </div>
</div>
